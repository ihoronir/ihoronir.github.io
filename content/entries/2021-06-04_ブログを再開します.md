+++
title = "ArchLinuxのブートローダーはsystemd-bootが便利"
updated = "2021-08-31"
slug = "ddd"

[taxonomies]
entry_lists = ["このサイトについて"]
+++
これまでずっと Linux のブートローダーとしては GRUB 使っていたのですが、どうやら systemd-boot が便利らしかったので使ってみました。

## systemd-boot とは

systemd-boot は systemd に同梱されているシンプルなブートローダーです。簡単な設定をするだけで使えるのでとてもお手軽で、 GRUB でパラメータをいじるときのような煩わしさはありません。ただし、 UEFI 環境でないと使えないので注意です。

## インストール

systemd-boot は systemd に同梱されているので、 ArchLinux では追加でパッケージをインストールする必要はありません。
EFI パーティションに systemd-boot をインストールするには、 bootctl コマンド使用します。

> systemd-boot は systemd に同梱されているので、 ArchLinux では追加でパッケージをインストールする必要はありません。
> EFI パーティションに systemd-boot をインストールするには、 bootctl コマンド使用します。

> systemd-boot は systemd に同梱されているので、 ArchLinux では追加でパッケージをインストールする必要はありません。
> > systemd-boot は systemd に同梱されているので、 ArchLinux では追加でパッケージをインストールする必要はありません。
> > systemd-boot は systemd に同梱されているので、 ArchLinux では追加でパッケージをインストールする必要はありません。
> > systemd-boot は systemd に同梱されているので、 ArchLinux では追加でパッケージをインストールする必要はありません。
> > EFI パーティションに systemd-boot をインストールするには、 bootctl コマンド使用します。
> > EFI パーティションに systemd-boot をインストールするには、 bootctl コマンド使用します。
> > EFI パーティションに systemd-boot をインストールするには、 bootctl コマンド使用します。
> EFI パーティションに systemd-boot をインストールするには、 bootctl コマンド使用します。
```bash
$ sudo bootctl --path=/boot install
```

`--path` パラメーターには EFI パーティションのマウントポイントを指定します。適宜置き換えてください。（この記事内では今後 /boot とします）
これで、 systemd-boot 関連のファイルが EFI パーティション内に展開されます。

## ローダーの設定

ブートメニューに表示するエントリを作成します。
`/boot/loader/entries/arch.conf` などを作成して編集します。下記はサンプルです。

```
title   Arch Linux
linux   /vmlinuz-linux
initrd  /initramfs-linux.img
options root=UUID=e4a4ca48-722b-44a0-9c7b-f745c0d0209d rw
```

- title: ブートメニューに表示する名前
- linux: カーネルイメージのパス（ただし、 /boot を root とする絶対パスで指定）
- initrd: initramfs のパス（ただし、 /boot を root とする絶対パスで指定）
- options: カーネルパラメータ

なお、 UUID などのパーティションの情報は `lsblk -f` で調べることができます。

続いて、先程作成したエントリが実際にブートメニューに表示されるように設定します。
`/boot/loader/loader.conf` を編集します。下記はサンプルです。

```
default arch
timeout 3
editor no
```

- default: デフォルトで選択されるエントリ
- timeout: デフォルトエントリが起動するまでの時間（秒）
- editor: カーネルパラメータの編集を許可するか（yes にすると誰でも簡単に root 権限を取得できてしまうので no が推奨）

Windows とデュアルブートしたい場合でも、 systemd-boot が自動で EFI パーティション内の Windows の EFI 実行可能ファイルを発見してブートメニューに表示するので特に追加の設定は必要ありません。

設定は以上で終わりです。これで systemd-boot が使えるようになります。やったー！

## systemd-boot のアップデート

systemd のアップデートが来たときなどに systemd-boot をアップデートするには、次のコマンドを使用します。

### systemd-boot のアップデート

systemd のアップデートが来たときなどに systemd-boot をアップデートするには、次のコマンドを使用します。

```bash
$ sudo bootctl update
```

## 参考

この記事に書いていることはほとんど ArchWiki の受け売りなので ArchWiki でもっと詳しい情報を確認することをおすすめします...（この記事の意味）

- [systemd-boot - ArchWiki](https://wiki.archlinux.jp/index.php/Systemd-boot)


