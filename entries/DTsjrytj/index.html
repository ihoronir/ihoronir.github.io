<!doctype html><html lang=ja><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><title>【C言語】碁盤目状の道路の最短経路数を求める - ihoronir.github.io</title><meta content=京都や札幌のような碁盤目状に道路が引かれた街で、ある交差点から別の交差点までの最短経路はいくつ存在するかを求めるプログラムを、C言語を使って実装してみました。「組み合わせ」や「書き込み方式」などを使った、複数の実装方法を紹介します。 name=description><link href=/base.css rel=stylesheet><link href=/entry.css rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css rel=stylesheet><link href=/favicon.png rel=icon><meta content=【C言語】碁盤目状の道路の最短経路数を求める property=og:title><meta content=website property=og:type><meta content=ihoronir.github.io property=og:site_name><meta content=https://ihoronir.github.io/entries/DTsjrytj/ property=og:url><meta content=https://ihoronir.github.io/cover.jpg property=og:image><meta content=ja_JP property=og:locale><meta content=summary name=twitter:card><meta content=@ihoronir name=twitter:creator><script src="https://www.googletagmanager.com/gtag/js?id=G-RZSDNPP2LL" async></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-RZSDNPP2LL')</script><body><header class=base_header><h1 class=base_header_logo><a class=base_header_logo_link href=/>ihoronir.<br class=base_header_logo_break>github.io</a></h1><nav class=base_header_nav><ul class=base_header_nav_list><li class="base_header_nav_list_Item base_header_nav_list_top"><a class=base_header_nav_list_Item_link href=/>トップページ</a><li class="base_header_nav_list_Item base_header_nav_list_entry"><a class="base_header_nav_list_Item_link base_header_nav_list_Item_link-now" href=/entries/>ブログ記事</a><li class="base_header_nav_list_Item base_header_nav_list_game"><a class=base_header_nav_list_Item_link href=/games/>ゲーム</a><li class="base_header_nav_list_Item base_header_nav_list_develop"><a class=base_header_nav_list_Item_link href=/develop/>開発</a><li class="base_header_nav_list_Item base_header_nav_list_music"><a class=base_header_nav_list_Item_link href=/music/>音楽</a><li class="base_header_nav_list_Item base_header_nav_list_photo"><a class=base_header_nav_list_Item_link href=/photos/>写真</a><li class="base_header_nav_list_Item base_header_nav_list_profile"><a class=base_header_nav_list_Item_link href=/profile/>自己紹介</a><li class="base_header_nav_list_Item base_header_nav_list_about"><a class=base_header_nav_list_Item_link href=/about/>このサイトについて</a></ul></nav><div class=base_header_ad_1><div>広告 Advertisement</div><div style="background: #333; width:300px; height:600px; margin: auto; padding: 40px 0; font-size: 32px; color: #777;">広告募集中</div></div><div class=base_header_ad_2><div>広告 Advertisement</div><div style="background: #333; width:160px; height:600px; margin: auto; padding: 40px 0; font-size: 32px; color: #777;">広告募集中</div></div></header><nav class=base_breadcrumb>現在地： <a href=/>トップ</a> / <a href=/entries/>ブログ記事</a> / <a href=/entries/DTsjrytj/>【C言語】碁盤目状の道路の最短経路数を求める</a></nav><main class="base_main entry"><article class=entry_article><header class=entry_article_header><h1 class=entry_article_header_title>【C言語】碁盤目状の道路の最短経路数を求める</h1><p class=entry_article_header_meta>この記事の公開日：2021-11-12<br> この記事の最終編集日：2021-11-19</header><h2 id=まえがき>まえがき</h2><p>プログラミングの練習として、碁盤目状に道路が引かれた街の、ある交差点から別の交差点までの最短経路の数を求めてみます。いくつか実装例を考えたので、同じようなことをしている誰かの参考になれば幸いです。使用するプログラミング言語はC言語です。<h2 id=やりたいこと>やりたいこと</h2><p>京都や札幌のような、碁盤目状に道路が引かれた街を考えます。<p>具体的には、東西と南北の2方向に道路が並行して走っており、交差点で道路は直交します。また、碁盤目のマスの幅はどこを見ても等しいものとします。<h3 id=入力>入力</h3><p>以下の2つの整数が与えられます。どちらの値も碁番目のマスの幅を1とします。また、必ず0以上の値をとります。<ul><li>2つの交差点間の東西方向の距離<li>2つの交差点間の南北方向の距離</ul><h3 id=出力>出力</h3><p>与えられた入力から次の1つの整数を出力します。<ul><li>2つの交差点間の最短経路数</ul><h3 id=例>例</h3><p>図中の交差点Aと交差点Bの間の最短経路数を考えます。<pre style=background-color:#1e1e1e;color:#dcdcdc;><code><span>  |  |  |  |  |
</span><span>--+--A--+--+--+--
</span><span>  |  |  |  |  |
</span><span>--+--+--+--B--+--
</span><span>  |  |  |  |  |    ↑北
</span></code></pre><p>入力は次の2つの整数です。<ul><li>AB間の東西方向の距離：2<li>AB間の南北方向の距離：1</ul><p>出力は次の1つの整数になります。<ul><li>AB間の最短経路数：3</ul><h2 id=組み合わせによる実装例>組み合わせによる実装例</h2><p>実装例では、変数名・仮引数名を次のように命名しています。<ul><li><code>h</code> ：2つの交差点間の東西方向の距離<li><code>v</code> ：2つの交差点間の南北方向の距離<li><code>n</code> ：組み合わせで、選ぶもとの集合の元の個数<li><code>r</code> ：組み合わせで、選ぶ個数</ul><p>このとき、求めたい最短経路数は、 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>h</mi></mrow><annotation encoding=application/x-tex>h</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal">h</span></span></span></span> と <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>v</mi></mrow><annotation encoding=application/x-tex>v</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>v</span></span></span></span> を用いて <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mrow></mrow><mrow><mi>h</mi><mo>+</mo><mi>v</mi></mrow></msub><msub><mi mathvariant=normal>C</mi><mi>v</mi></msub></mrow><annotation encoding=application/x-tex>{}_{h+v} \mathrm{C}_v</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8917em;vertical-align:-0.2083em;></span><span class=mord><span class=mord></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style=margin-right:0.03588em;>v</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2083em;><span></span></span></span></span></span></span><span class=mord><span class="mord mathrm">C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03588em;>v</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span> で表されます。<h3 id=for_ループによる実装>for ループによる実装</h3><p>次の式で <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mrow></mrow><mi>n</mi></msub><msub><mi mathvariant=normal>C</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>{}_n \mathrm{C}_r</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class=mord></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mord><span class="mord mathrm">C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.02778em;>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span> を計算することできます。<p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mrow></mrow><mi>n</mi></msub><msub><mi mathvariant=normal>C</mi><mi>r</mi></msub><mo>=</mo><mfrac><mrow><mo stretchy=false>(</mo><mi>n</mi><mo>−</mo><mi>r</mi><mo>+</mo><mn>1</mn><mo stretchy=false>)</mo><mo stretchy=false>(</mo><mi>n</mi><mo>−</mo><mi>r</mi><mo>+</mo><mn>2</mn><mo stretchy=false>)</mo><mo stretchy=false>(</mo><mi>n</mi><mo>−</mo><mi>r</mi><mo>+</mo><mn>3</mn><mo stretchy=false>)</mo><mo>⋯</mo><mo stretchy=false>(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo><mi>n</mi></mrow><mrow><mn>1</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>3</mn><mo>⋯</mo><mo stretchy=false>(</mo><mi>r</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo><mi>r</mi></mrow></mfrac></mrow><annotation encoding=application/x-tex>{}_n \mathrm{C}_r = \frac{(n-r+1)(n-r+2)(n-r+3) \cdots (n-1)n} { 1 \cdot2 \cdot3 \cdots (r-1)r}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class=mord></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mord><span class="mord mathrm">C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.02778em;>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:2.363em;vertical-align:-0.936em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.427em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>1</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⋅</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord>2</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⋅</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord>3</span><span class=mspace style=margin-right:0.1667em;></span><span class=minner>⋯</span><span class=mspace style=margin-right:0.1667em;></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord>1</span><span class=mclose>)</span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mopen>(</span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord>1</span><span class=mclose>)</span><span class=mopen>(</span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord>2</span><span class=mclose>)</span><span class=mopen>(</span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord>3</span><span class=mclose>)</span><span class=mspace style=margin-right:0.1667em;></span><span class=minner>⋯</span><span class=mspace style=margin-right:0.1667em;></span><span class=mopen>(</span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord>1</span><span class=mclose>)</span><span class="mord mathnormal">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.936em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p>これをそのまま for ループで実装したのが、次のコードです。分母と分子を分けて求め、最後に分子を分母で割っています。<pre class=language-c data-lang=c style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-c data-lang=c><span style=color:#9b9b9b;>#include </span><span style=color:#d69d85;>&LTstdio.h>
</span><span>
</span><span style=color:#569cd6;>int </span><span>combination(</span><span style=color:#569cd6;>int </span><span>n, </span><span style=color:#569cd6;>int </span><span>r) {
</span><span>    </span><span style=color:#569cd6;>int</span><span> a = </span><span style=color:#b5cea8;>1</span><span>, b = </span><span style=color:#b5cea8;>1</span><span>;
</span><span>    </span><span style=color:#569cd6;>int</span><span> i;
</span><span>
</span><span>    </span><span style=color:#569cd6;>for </span><span>(i = </span><span style=color:#b5cea8;>1</span><span>; i <= r; i ++) {
</span><span>        a *= n - r + i;
</span><span>        b *= i;
</span><span>    }
</span><span>
</span><span>    </span><span style=color:#569cd6;>return</span><span> a / b;
</span><span>}
</span><span>
</span><span style=color:#569cd6;>int </span><span>main(</span><span style=color:#569cd6;>void</span><span>) {
</span><span>    </span><span style=color:#569cd6;>int</span><span> h, v;
</span><span>
</span><span>    printf(</span><span style=color:#d69d85;>"2つの交差点間の東西方向の距離："</span><span>); fflush(stdout); scanf(</span><span style=color:#d69d85;>"</span><span style=color:#b4cea8;>%d</span><span style=color:#d69d85;>"</span><span>, </span><span style=color:#569cd6;>&</span><span>h);
</span><span>    printf(</span><span style=color:#d69d85;>"2つの交差点間の南北方向の距離："</span><span>); fflush(stdout); scanf(</span><span style=color:#d69d85;>"</span><span style=color:#b4cea8;>%d</span><span style=color:#d69d85;>"</span><span>, </span><span style=color:#569cd6;>&</span><span>v);
</span><span>
</span><span>    printf(</span><span style=color:#d69d85;>"2つの交差点間の最短経路数：</span><span style=color:#b4cea8;>%d</span><span style=color:#e3bbab;>\n</span><span style=color:#d69d85;>"</span><span>, combination(h + v, v));
</span><span>    
</span><span>    </span><span style=color:#569cd6;>return </span><span style=color:#b5cea8;>0</span><span>;
</span><span>}
</span></code></pre><p>この実装は、入力の値が少しでも大きくなると、すぐに <code>combination</code> 関数内の変数 <code>a</code>, <code>b</code> が桁溢れしてしまうという問題があります。<h3 id=再帰による実装>再帰による実装</h3><p>for ループによる実装の桁溢れ問題を解決するため、 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mrow></mrow><mi>n</mi></msub><msub><mi mathvariant=normal>C</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>{}_n \mathrm{C}_r</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class=mord></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mord><span class="mord mathrm">C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.02778em;>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span> の再帰的定義に基づいて組み合わせを計算してみます。 <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mrow></mrow><mi>n</mi></msub><msub><mi mathvariant=normal>C</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>{}_n \mathrm{C}_r</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class=mord></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mord><span class="mord mathrm">C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.02778em;>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span> は次のように再帰的に定義されます。<p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mtable columnalign="right left" columnspacing=0em rowspacing=0.25em><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow><msub><mrow></mrow><mi>n</mi></msub><msub><mi mathvariant=normal>C</mi><mn>0</mn></msub></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow><msub><mrow></mrow><mi>n</mi></msub><msub><mi mathvariant=normal>C</mi><mi>r</mi></msub></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><msub><mrow></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi mathvariant=normal>C</mi><mrow><mi>r</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>×</mo><mfrac><mi>n</mi><mi>r</mi></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{split} {}_n \mathrm{C}_0 & = 1\\ {}_n \mathrm{C}_r & = {}_{n-1} \mathrm{C}_{r-1} \times \frac{n}{r} \end{split}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:3.5936em;vertical-align:-1.5468em;></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.0468em;><span style=top:-4.3143em;><span class=pstrut style=height:3.1076em;></span><span class=mord><span class=mord><span class=mord></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mord><span class="mord mathrm">C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span><span style=top:-2.5468em;><span class=pstrut style=height:3.1076em;></span><span class=mord><span class=mord><span class=mord></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mord><span class="mord mathrm">C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.02778em;>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.5468em;><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.0468em;><span style=top:-4.3143em;><span class=pstrut style=height:3.1076em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>1</span></span></span><span style=top:-2.5468em;><span class=pstrut style=height:3.1076em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord><span class=mord></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2083em;><span></span></span></span></span></span></span><span class=mord><span class="mord mathrm">C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.02778em;>r</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2083em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>×</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.1076em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.02778em;>r</span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class="mord mathnormal">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.686em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.5468em;><span></span></span></span></span></span></span></span></span></span></span></span><p>この定義を使って再帰関数で実装したのが、次のコードです。<pre class=language-c data-lang=c style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-c data-lang=c><span style=color:#9b9b9b;>#include </span><span style=color:#d69d85;>&LTstdio.h>
</span><span>
</span><span style=color:#569cd6;>int </span><span>combination(</span><span style=color:#569cd6;>int </span><span>n, </span><span style=color:#569cd6;>int </span><span>r) {
</span><span>    </span><span style=color:#569cd6;>if </span><span>(r == </span><span style=color:#b5cea8;>0</span><span>) </span><span style=color:#569cd6;>return </span><span style=color:#b5cea8;>1</span><span>;
</span><span>    </span><span style=color:#569cd6;>return </span><span>combination(n - </span><span style=color:#b5cea8;>1</span><span>, r - </span><span style=color:#b5cea8;>1</span><span>) </span><span style=color:#569cd6;>*</span><span> n / r;
</span><span>}
</span><span>
</span><span style=color:#569cd6;>int </span><span>main(</span><span style=color:#569cd6;>void</span><span>) {
</span><span>    </span><span style=color:#569cd6;>int</span><span> h, v;
</span><span>
</span><span>    printf(</span><span style=color:#d69d85;>"2つの交差点間の東西方向の距離："</span><span>); fflush(stdout); scanf(</span><span style=color:#d69d85;>"</span><span style=color:#b4cea8;>%d</span><span style=color:#d69d85;>"</span><span>, </span><span style=color:#569cd6;>&</span><span>h);
</span><span>    printf(</span><span style=color:#d69d85;>"2つの交差点間の南北方向の距離："</span><span>); fflush(stdout); scanf(</span><span style=color:#d69d85;>"</span><span style=color:#b4cea8;>%d</span><span style=color:#d69d85;>"</span><span>, </span><span style=color:#569cd6;>&</span><span>v);
</span><span>
</span><span>    printf(</span><span style=color:#d69d85;>"2つの交差点間の最短経路数：</span><span style=color:#b4cea8;>%d</span><span style=color:#e3bbab;>\n</span><span style=color:#d69d85;>"</span><span>, combination(h + v, v));
</span><span>
</span><span>    </span><span style=color:#569cd6;>return </span><span style=color:#b5cea8;>0</span><span>;
</span><span>}
</span></code></pre><p>for ループを使った実装では対応しきれなかった大きな入力にも対応するようになりました。コードの見通しも良くなったのではないでしょうか。<h2 id=「書き込み方式」による実装例>「書き込み方式」による実装例</h2><p>「書き込み方式」で最短経路数を求められる原理は、下記ウェブページに書かれています。<ul><li><a href=https://manabitimes.jp/math/962>道順の場合の数を求めるテクニック | 高校数学の美しい物語</a></ul><p>「書き込み方式」を今回の問題に当てはめる上で重要なポイントは次の2つです。<ul><li>スタート地点から見て、東西方向または南北方向の距離が0であれば、その交差点にたどり着く最短経路数は1である。<li>スタート地点から見て、東西方向・南北方向の距離がどちらも0でなければ、その交差点にたどり着く最短経路数は、その直前に通り過ぎうる2つの交差点それぞれにたどり着く最短経路数の和である。</ul><p>これをそのまま再帰関数で実装したのが、次のコードです。<pre class=language-c data-lang=c style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-c data-lang=c><span style=color:#9b9b9b;>#include </span><span style=color:#d69d85;>&LTstdio.h>
</span><span>
</span><span style=color:#569cd6;>int </span><span>route(</span><span style=color:#569cd6;>int </span><span>h, </span><span style=color:#569cd6;>int </span><span>v) {
</span><span>    </span><span style=color:#569cd6;>if </span><span>(h == </span><span style=color:#b5cea8;>0 </span><span>|| v == </span><span style=color:#b5cea8;>0</span><span>) </span><span style=color:#569cd6;>return </span><span style=color:#b5cea8;>1</span><span>;
</span><span>    </span><span style=color:#569cd6;>return </span><span>route(h - </span><span style=color:#b5cea8;>1</span><span>, v) + route(h, v - </span><span style=color:#b5cea8;>1</span><span>);
</span><span>}
</span><span>
</span><span style=color:#569cd6;>int </span><span>main(</span><span style=color:#569cd6;>void</span><span>) {
</span><span>    </span><span style=color:#569cd6;>int</span><span> h, v;
</span><span>
</span><span>    printf(</span><span style=color:#d69d85;>"2つの交差点間の東西方向の距離："</span><span>); fflush(stdout); scanf(</span><span style=color:#d69d85;>"</span><span style=color:#b4cea8;>%d</span><span style=color:#d69d85;>"</span><span>, </span><span style=color:#569cd6;>&</span><span>h);
</span><span>    printf(</span><span style=color:#d69d85;>"2つの交差点間の南北方向の距離："</span><span>); fflush(stdout); scanf(</span><span style=color:#d69d85;>"</span><span style=color:#b4cea8;>%d</span><span style=color:#d69d85;>"</span><span>, </span><span style=color:#569cd6;>&</span><span>v);
</span><span>
</span><span>    printf(</span><span style=color:#d69d85;>"2つの交差点間の最短経路数：</span><span style=color:#b4cea8;>%d</span><span style=color:#e3bbab;>\n</span><span style=color:#d69d85;>"</span><span>, route(h, v));
</span><span>
</span><span>    </span><span style=color:#569cd6;>return </span><span style=color:#b5cea8;>0</span><span>;
</span><span>}
</span></code></pre><p>個人的には、この実装が一番直感的で分かりやすいと思います。ただ、効率は悪いです。<h2 id=あとがき>あとがき</h2><p>いろいろな方法で碁盤目状の道路の最短経路数を求めてみました。再帰を使うと、簡単に問題を解決できたので、再帰は便利だなと思いました。</article><aside class=entry_ref><div class=entry_ref_ad_1><div>広告 Advertisement</div><div style="background: #333; width:336px; height:280px; margin: auto; padding: 40px 0; font-size: 32px; color: #777;">広告募集中</div></div><div class=entry_ref_ad_2><div>広告 Advertisement</div><div style="background: #333; width:300px; height:250px; margin: auto; padding: 40px 0; font-size: 32px; color: #777;">広告募集中</div></div><section class=entry_ref_toc><h2 class=entry_ref_Section_header>目次</h2><ul class=entry_ref_toc_list><li class=entry_ref_toc_list_Item><a class=entry_ref_toc_list_Item_link href=#まえがき>まえがき</a><li class=entry_ref_toc_list_Item><a class=entry_ref_toc_list_Item_link href=#やりたいこと>やりたいこと</a> <ul class=entry_ref_toc_list_Item_list><li class=entry_ref_toc_list_Item_list_Item><a class=entry_ref_toc_list_Item_list_Item_link href=#入力>入力</a><li class=entry_ref_toc_list_Item_list_Item><a class=entry_ref_toc_list_Item_list_Item_link href=#出力>出力</a><li class=entry_ref_toc_list_Item_list_Item><a class=entry_ref_toc_list_Item_list_Item_link href=#例>例</a></ul><li class=entry_ref_toc_list_Item><a class=entry_ref_toc_list_Item_link href=#組み合わせによる実装例>組み合わせによる実装例</a> <ul class=entry_ref_toc_list_Item_list><li class=entry_ref_toc_list_Item_list_Item><a class=entry_ref_toc_list_Item_list_Item_link href=#for_ループによる実装>for ループによる実装</a><li class=entry_ref_toc_list_Item_list_Item><a class=entry_ref_toc_list_Item_list_Item_link href=#再帰による実装>再帰による実装</a></ul><li class=entry_ref_toc_list_Item><a class=entry_ref_toc_list_Item_link href=#「書き込み方式」による実装例>「書き込み方式」による実装例</a><li class=entry_ref_toc_list_Item><a class=entry_ref_toc_list_Item_link href=#あとがき>あとがき</a></ul></section></aside></main><footer class=base_footer><small class=footer_copyrights>Copyrights © Ihoronir All Rights Reserved.</small></footer>