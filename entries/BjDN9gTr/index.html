<!doctype html><html lang=ja><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><title>【C言語】switch文のフォールスルーの便利かもしれない使い方 - ihoronir.github.io</title><meta content="C言語で、 switch 文の「フォールスルー」という挙動を使って、「日付を入力するとその日がその年の何日目かを出力するプログラム」を非常に簡潔に実装する方法を思いついたので、紹介します。一般的にくせ者扱いされがちな「フォールスルー」の意外に便利な活用方法の紹介です。" name=description><link href=/base.css rel=stylesheet><link href=/entry.css rel=stylesheet><link href=https://ihoronir.github.io/favicon.png rel=icon><link href=https://ihoronir.github.io/atom.xml rel=alternate title=Atom type=application/atom+xml><meta content=【C言語】switch文のフォールスルーの便利かもしれない使い方 property=og:title><meta content="C言語で、 switch 文の「フォールスルー」という挙動を使って、「日付を入力するとその日がその年の何日目かを出力するプログラム」を非常に簡潔に実装する方法を思いついたので、紹介します。一般的にくせ者扱いされがちな「フォールスルー」の意外に便利な活用方法の紹介です。" property=og:description><meta content=website property=og:type><meta content=ihoronir.github.io property=og:site_name><meta content=https://ihoronir.github.io/entries/BjDN9gTr/ property=og:url><meta content=https://ihoronir.github.io/cover.jpg property=og:image><meta content=ja_JP property=og:locale><meta content=summary name=twitter:card><meta content=@ihoronir name=twitter:creator><script src="https://www.googletagmanager.com/gtag/js?id=G-RZSDNPP2LL" async></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-RZSDNPP2LL')</script><body><header class=base_header><h1 class=base_header_logo><a class=base_header_logo_link href=/>ihoronir.<br class=base_header_logo_break>github.io</a></h1><nav class=base_header_nav><ul class=base_header_nav_list><li class="base_header_nav_list_Item base_header_nav_list_top"><a class=base_header_nav_list_Item_link href=/>トップページ</a><li class="base_header_nav_list_Item base_header_nav_list_entry"><a class="base_header_nav_list_Item_link base_header_nav_list_Item_link-now" href=/entries/>ブログ記事</a><li class="base_header_nav_list_Item base_header_nav_list_game"><a class=base_header_nav_list_Item_link href=/games/>ゲーム</a><li class="base_header_nav_list_Item base_header_nav_list_develop"><a class=base_header_nav_list_Item_link href=/develop/>開発</a><li class="base_header_nav_list_Item base_header_nav_list_music"><a class=base_header_nav_list_Item_link href=/music/>音楽</a><li class="base_header_nav_list_Item base_header_nav_list_photo"><a class=base_header_nav_list_Item_link href=/photos/>写真</a><li class="base_header_nav_list_Item base_header_nav_list_profile"><a class=base_header_nav_list_Item_link href=/profile/>自己紹介</a><li class="base_header_nav_list_Item base_header_nav_list_about"><a class=base_header_nav_list_Item_link href=/about/>このサイトについて</a></ul></nav></header><nav class=base_breadcrumb><ul class=base_breadcrumb_list><li class="base_breadcrumb_list_Item base_breadcrumb_list_Item-first"><a href=/>トップ</a><li class="base_breadcrumb_list_Item base_breadcrumb_list_Item-notfirst"><a href=/entries/>ブログ記事</a><li class="base_breadcrumb_list_Item base_breadcrumb_list_Item-notfirst"><a href=/entries/BjDN9gTr/>【C言語】switch文のフォールスルーの便利かもしれない使い方</a></ul></nav><main class="base_main entry"><article class="entry_article lib_article"><header class=entry_article_header><h1 class=entry_article_header_title>【C言語】switch文のフォールスルーの便利かもしれない使い方</h1><p class=entry_article_header_meta>この記事の公開日： <time datetime=2021-10-13>2021年 10月 13日</time><br>この記事の最終編集日： <time>2021年 10月 13日</time></header><h2 id=まえがき>まえがき</h2><p>switch 文のフォールスルーの便利かもしれない使い方を発見したので紹介します。使用するプログラミング言語はC言語です。<p>一般的には switch 文でフォールスルーを使うことはバグの温床として忌避されているような気がするので、そういった意味では今回紹介するコードはあんまり良くないかもしれないですが、まあ話半分で読んでもらえたらなと思います。（いい加減ですみません！）<h2 id=フォールスルーとは>フォールスルーとは</h2><p>そもそもフォールスルーというのは、「 switch 文で break を書かなかった場合に制御が switch 文から抜け出さず、後続の case に続く文が実行される。」ことを指します。次に示すコードが例です。<pre class=language-c data-lang=c style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-c data-lang=c><span style=color:#9b9b9b;>#include </span><span style=color:#d69d85;>&LTstdio.h>
</span><span style=color:#569cd6;>int </span><span>main(</span><span style=color:#569cd6;>void</span><span>) {
</span><span>    </span><span style=color:#569cd6;>int</span><span> num;
</span><span>    scanf(</span><span style=color:#d69d85;>"</span><span style=color:#b4cea8;>%d</span><span style=color:#d69d85;>"</span><span>, </span><span style=color:#569cd6;>&</span><span>num);
</span><span>    </span><span style=color:#569cd6;>switch </span><span>(num) {
</span><span>        </span><span style=color:#569cd6;>case </span><span style=color:#b5cea8;>1</span><span>: puts(</span><span style=color:#d69d85;>"hoge"</span><span>);
</span><span>        </span><span style=color:#569cd6;>case </span><span style=color:#b5cea8;>2</span><span>: puts(</span><span style=color:#d69d85;>"fuga"</span><span>);
</span><span>        </span><span style=color:#569cd6;>case </span><span style=color:#b5cea8;>3</span><span>: puts(</span><span style=color:#d69d85;>"foo"</span><span>); </span><span style=color:#569cd6;>break</span><span>;
</span><span>        </span><span style=color:#569cd6;>case </span><span style=color:#b5cea8;>4</span><span>: puts(</span><span style=color:#d69d85;>"bar"</span><span>);
</span><span>    }
</span><span>    </span><span style=color:#569cd6;>return </span><span style=color:#b5cea8;>0</span><span>;
</span><span>}
</span></code></pre><pre class=language-bash data-lang=bash style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-bash data-lang=bash><span style=color:#608b4e;># 入力
</span><span>1
</span><span style=color:#608b4e;># 出力
</span><span>hoge
</span><span>fuga
</span><span>foo
</span></code></pre><p>入力が <code>1</code> だったので switch 文の中の <code>case 1:</code> 以降の文が、 break が登場するまで実行されました。こんな感じで case に対応する break を意図的に省くことで、制御が次の case へと落ちていくようなプログラムを書くことができます。これがフォールスルーです。<p>フォールスルーを使うと「日付を入力するとその日がその年の何日目かを出力するプログラム」をシンプルに書けるということに気づいたので、実装例を紹介します。<h2 id=実装例>実装例</h2><p>以下が switch 文のフォールスルーを使った「日付を入力するとその日がその年の何日目かを出力するプログラム」の実装例です。（うるう年は考慮していません）<pre class=language-c data-lang=c style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-c data-lang=c><span style=color:#9b9b9b;>#include </span><span style=color:#d69d85;>&LTstdio.h>
</span><span style=color:#569cd6;>int </span><span>main(</span><span style=color:#569cd6;>void</span><span>) {
</span><span>    </span><span style=color:#569cd6;>int</span><span> month, day;
</span><span>    </span><span style=color:#569cd6;>int</span><span> count = </span><span style=color:#b5cea8;>0</span><span>;
</span><span>    scanf(</span><span style=color:#d69d85;>"</span><span style=color:#b4cea8;>%d %d</span><span style=color:#d69d85;>"</span><span>, </span><span style=color:#569cd6;>&</span><span>month, </span><span style=color:#569cd6;>&</span><span>day);
</span><span>    </span><span style=color:#569cd6;>switch </span><span>(month - </span><span style=color:#b5cea8;>1</span><span>) {
</span><span>        </span><span style=color:#569cd6;>case </span><span style=color:#b5cea8;>11</span><span>: count += </span><span style=color:#b5cea8;>30</span><span>;
</span><span>        </span><span style=color:#569cd6;>case </span><span style=color:#b5cea8;>10</span><span>: count += </span><span style=color:#b5cea8;>31</span><span>;
</span><span>        </span><span style=color:#569cd6;>case </span><span style=color:#b5cea8;>9</span><span>: count += </span><span style=color:#b5cea8;>30</span><span>;
</span><span>        </span><span style=color:#569cd6;>case </span><span style=color:#b5cea8;>8</span><span>: count += </span><span style=color:#b5cea8;>31</span><span>;
</span><span>        </span><span style=color:#569cd6;>case </span><span style=color:#b5cea8;>7</span><span>: count += </span><span style=color:#b5cea8;>31</span><span>;
</span><span>        </span><span style=color:#569cd6;>case </span><span style=color:#b5cea8;>6</span><span>: count += </span><span style=color:#b5cea8;>30</span><span>;
</span><span>        </span><span style=color:#569cd6;>case </span><span style=color:#b5cea8;>5</span><span>: count += </span><span style=color:#b5cea8;>31</span><span>;
</span><span>        </span><span style=color:#569cd6;>case </span><span style=color:#b5cea8;>4</span><span>: count += </span><span style=color:#b5cea8;>30</span><span>;
</span><span>        </span><span style=color:#569cd6;>case </span><span style=color:#b5cea8;>3</span><span>: count += </span><span style=color:#b5cea8;>31</span><span>;
</span><span>        </span><span style=color:#569cd6;>case </span><span style=color:#b5cea8;>2</span><span>: count += </span><span style=color:#b5cea8;>28</span><span>;
</span><span>        </span><span style=color:#569cd6;>case </span><span style=color:#b5cea8;>1</span><span>: count += </span><span style=color:#b5cea8;>31</span><span>;
</span><span>    }
</span><span>    count += day;
</span><span>    printf(</span><span style=color:#d69d85;>"</span><span style=color:#b4cea8;>%d</span><span style=color:#e3bbab;>\n</span><span style=color:#d69d85;>"</span><span>, count);
</span><span>    </span><span style=color:#569cd6;>return </span><span style=color:#b5cea8;>0</span><span>;
</span><span>}
</span></code></pre><pre class=language-bash data-lang=bash style=background-color:#1e1e1e;color:#dcdcdc;><code class=language-bash data-lang=bash><span style=color:#608b4e;># 入力
</span><span>12 31
</span><span style=color:#608b4e;># 出力
</span><span>365
</span></code></pre><p>フォールスルーを使ったおかげで、結構シンプルに実装できているのではないでしょうか。<h2 id=補足：配列や繰り返しを使わなかった理由>補足：配列や繰り返しを使わなかった理由</h2><p>この実装は大学の課題で作成したあるプログラムの一部で使用したものなんですが、大学の授業ではまだ配列や繰り返しを扱っておらず、課題でそれらの機能を使ってはいけないという縛りがあったため、配列や繰り返しは使いませんでした。<p>結果的にこの縛りのおかげでフォールスルーの面白い使い方を見つけられたので良かったんではないでしょうか。（何目線）<h2 id=あとがき>あとがき</h2><p>プログラムを書くのって面白いですね！</article><aside class=entry_ref><section class=entry_ref_toc><h2 class=entry_ref_Section_header>目次</h2><ul class=entry_ref_toc_list><li class=entry_ref_toc_list_Item><a class=entry_ref_toc_list_Item_link href=#まえがき>まえがき</a><li class=entry_ref_toc_list_Item><a class=entry_ref_toc_list_Item_link href=#フォールスルーとは>フォールスルーとは</a><li class=entry_ref_toc_list_Item><a class=entry_ref_toc_list_Item_link href=#実装例>実装例</a><li class=entry_ref_toc_list_Item><a class=entry_ref_toc_list_Item_link href=#補足：配列や繰り返しを使わなかった理由>補足：配列や繰り返しを使わなかった理由</a><li class=entry_ref_toc_list_Item><a class=entry_ref_toc_list_Item_link href=#あとがき>あとがき</a></ul></section></aside></main><footer class=base_footer><small class=footer_copyrights>Copyrights © Ihoronir All Rights Reserved.</small></footer>